<!DOCTYPE html>
<html>
<head>
<!--$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$-->
<style>
#resultDIV{
	border: 1px solid black;
    margin-bottom: 10px;	
}	
#userDIV {
    border: 1px solid black;
    margin-bottom: 10px;	
}	
#dealerDIV {
    border: 1px solid black;
    margin-bottom: 10px;
}
body{
		background-image: url("bg.png");
}
</style>	
<!--$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$-->	
  <title>Blackjack</title>
  <script language="JavaScript">
<!-- Begin
var card2;	
 
var counte; var i; var precard=[]; var presuit=[];                   //thêm biến cho việc tránh bị lặp bài
var gameOver; var cardCount;
function Shuffle(max){
var num=Math.random()*max;
return Math.round(num)+1;
}	 
	  
function getSuit(){
suit = Shuffle(4);
if(suit == 1) return "Spades";
if(suit == 2) return "Clubs";
if(suit == 3) return "Diamonds";
else return "Hearts";
}
	  
function cardName(card){
if(card == 1) return "Ace";
if(card == 11) return "Jack";
if(card == 12) return "Queen";
if(card == 13) return "King";
return "" + card;
}
	  
function cardValue(card,strWho){  //biến strwho để xác định lượt
if(card == 1) {
	if(strWho =="You" && document.display.you.value >10){
	document.display.say2.value=document.display.say2.value+" Low"; return 1;}
	else return 11; }
 if(card > 10) return 10; 
return card;
}
	  
function PickACard(strWho){
card = Shuffle(12); //12?	
suit = getSuit();
//######################################################################################################
counte+=1;                                   //thêm phần chống lặp bàicounte+=1;                                   
if (counte!=1){
	for (i=1;i<counte;i++){
		while (card==precard[i] && suit==presuit[i]){
			card = Shuffle(12); 	
			suit = getSuit();
		}	
	}
}
precard[counte]=card;presuit[counte]=suit;
//#####################################################################################################
card2=cardName(card);
if(strWho =="You")
{document.display.say2.value=(cardName(card) + " of " + suit);  //say2 là bài của người chơi
//   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
 var x = document.createElement("IMG");
if (card2=="Ace" && suit=="Spades"){                                       //thêm phần hiện hình quân bài của player
	x.setAttribute("src","ace_of_spades.png");};
if (card2=="Ace" && suit=="Clubs"){
	x.setAttribute("src", "ace_of_clubs.png");};
if (card2=="Ace" && suit=="Diamonds"){
	x.setAttribute("src", "ace_of_diamonds.png");};
if (card2=="Ace" && suit=="Hearts"){
	x.setAttribute("src", "ace_of_hearts.png");};
if (card==2 && suit=="Spades"){
	x.setAttribute("src", "2_of_spades.png");};
if (card==2 && suit=="Clubs"){
	x.setAttribute("src", "2_of_clubs.png");};
if (card==2 && suit=="Diamonds"){
	x.setAttribute("src", "2_of_diamonds.png");};
if (card==2 && suit=="Hearts"){
	x.setAttribute("src", "2_of_hearts.png");};
if (card==3 && suit=="Spades"){
	x.setAttribute("src", "3_of_spades.png");};
if (card==3 && suit=="Clubs"){
	x.setAttribute("src", "3_of_clubs.png");};
if (card==3 && suit=="Diamonds"){
	x.setAttribute("src", "3_of_diamonds.png");};
if (card==3 && suit=="Hearts"){
	x.setAttribute("src","3_of_hearts.png");};
if (card==4 && suit=="Spades"){
	x.setAttribute("src", "4_of_spades.png");};
if (card==4 && suit=="Clubs"){
	x.setAttribute("src", "4_of_clubs.png");};
if (card==4 && suit=="Diamonds"){
	x.setAttribute("src", "4_of_diamonds.png");};
if (card==4 && suit=="Hearts"){
	x.setAttribute("src", "4_of_hearts.png");};
if (card==5 && suit=="Spades"){
	x.setAttribute("src", "5_of_spades.png");};
if (card==5 && suit=="Clubs"){
	x.setAttribute("src", "5_of_clubs.png");};
if (card==5 && suit=="Diamonds"){
	x.setAttribute("src", "5_of_diamonds.png");};
if (card==5 && suit=="Hearts"){
	x.setAttribute("src","5_of_hearts.png");};
if (card==6 && suit=="Spades"){
	x.setAttribute("src", "6_of_spades.png");}	;
if (card==6 && suit=="Clubs"){
	x.setAttribute("src", "6_of_clubs.png");}	;
if (card==6 && suit=="Diamonds"){
	x.setAttribute("src", "6_of_diamonds.png");}	;
if (card==6 && suit=="Hearts"){
	x.setAttribute("src", "6_of_hearts.png");}	;
if (card==7 && suit=="Spades"){
	x.setAttribute("src", "7_of_spades.png");}	;
if (card==8 && suit=="Spades"){
	x.setAttribute("src", "8_of_spades.png");}	;
if (card==9 && suit=="Spades"){
	x.setAttribute("src", "9_of_spades.png");}	;
if (card==10 && suit=="Spades"){
	x.setAttribute("src", "10_of_spades.png");}	;
if (card2=="Jack" && suit=="Spades"){
	x.setAttribute("src", "jack_of_spades2.png");}	;
if (card2=="Queen" && suit=="Spades"){
	x.setAttribute("src", "queen_of_spades2.png");}	;
if (card2=="King" && suit=="Spades"){
	x.setAttribute("src", "king_of_spades2.png");}	;
if (card==7 && suit=="Clubs"){
	x.setAttribute("src", "7_of_clubs.png");}	;
if (card==8 && suit=="Clubs"){
	x.setAttribute("src", "8_of_clubs.png");}	;
if (card==9 && suit=="Clubs"){
	x.setAttribute("src", "9_of_clubs.png");}	;
if (card==10 && suit=="Clubs"){
	x.setAttribute("src", "10_of_clubs.png");}	;
if (card2=="Jack" && suit=="Clubs"){
	x.setAttribute("src", "jack_of_clubs2.png");}	;
if (card2=="Queen" && suit=="Clubs"){
	x.setAttribute("src", "queen_of_clubs2.png");}	;
if (card2=="King" && suit=="Clubs"){
	x.setAttribute("src", "king_of_clubs2.png");}	;
if (card2==7 && suit=="Diamonds"){
	x.setAttribute("src", "7_of_diamonds.png");}	;
if (card==8 && suit=="Diamonds"){
	x.setAttribute("src", "8_of_diamonds.png");}	;
if (card==9 && suit=="Diamonds"){
	x.setAttribute("src", "9_of_diamonds.png");}	;
if (card==10 && suit=="Diamonds"){
	x.setAttribute("src", "10_of_diamonds.png");}	;
if (card2=="Jack" && suit=="Diamonds"){
	x.setAttribute("src", "jack_of_diamonds2.png");}	;
if (card2=="Queen" && suit=="Diamonds"){
	x.setAttribute("src", "queen_of_diamonds2.png");}	;
if (card2=="King" && suit=="Diamonds"){
	x.setAttribute("src", "king_of_diamonds2.png");}	;
if (card2==7 && suit=="Hearts"){
	x.setAttribute("src", "7_of_hearts.png");}	;
if (card==8 && suit=="Hearts"){
	x.setAttribute("src", "8_of_hearts.png");}	;
if (card==9 && suit=="Hearts"){
	x.setAttribute("src", "9_of_hearts.png");}	;
if (card2==10 && suit=="Hearts"){
	x.setAttribute("src", "10_of_hearts.png");}	;
if (card2=="Jack" && suit=="Hearts"){
	x.setAttribute("src", "jack_of_hearts2.png");}	;
if (card2=="Queen" && suit=="Hearts"){
	x.setAttribute("src", "queen_of_hearts2.png");}	;
if (card2=="King" && suit=="Hearts"){
	x.setAttribute("src", "king_of_hearts2.png");}	;
	
x.setAttribute("width", "120");
x.setAttribute("height", "170");
x.setAttribute("alt", "card");	
document.getElementById("userDIV").appendChild(x);
// @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
}
else {
document.display.say1.value=(cardName(card) + " of " + suit);
var x = document.createElement("IMG");
if (card2=="Ace" && suit=="Spades"){                                       //thêm phần hiện hình các quân bài của dealer
	x.setAttribute("src","ace_of_spades.png");};
if (card2=="Ace" && suit=="Clubs"){
	x.setAttribute("src", "ace_of_clubs.png");};
if (card2=="Ace" && suit=="Diamonds"){
	x.setAttribute("src", "ace_of_diamonds.png");};
if (card2=="Ace" && suit=="Hearts"){
	x.setAttribute("src", "ace_of_hearts.png");};
if (card==2 && suit=="Spades"){
	x.setAttribute("src", "2_of_spades.png");};
if (card==2 && suit=="Clubs"){
	x.setAttribute("src", "2_of_clubs.png");};
if (card==2 && suit=="Diamonds"){
	x.setAttribute("src", "2_of_diamonds.png");};
if (card==2 && suit=="Hearts"){
	x.setAttribute("src", "2_of_hearts.png");};
if (card==3 && suit=="Spades"){
	x.setAttribute("src", "3_of_spades.png");};
if (card==3 && suit=="Clubs"){
	x.setAttribute("src", "3_of_clubs.png");};
if (card==3 && suit=="Diamonds"){
	x.setAttribute("src", "3_of_diamonds.png");};
if (card==3 && suit=="Hearts"){
	x.setAttribute("src","3_of_hearts.png");};
if (card==4 && suit=="Spades"){
	x.setAttribute("src", "4_of_spades.png");};
if (card==4 && suit=="Clubs"){
	x.setAttribute("src", "4_of_clubs.png");};
if (card==4 && suit=="Diamonds"){
	x.setAttribute("src", "4_of_diamonds.png");};
if (card==4 && suit=="Hearts"){
	x.setAttribute("src", "4_of_hearts.png");};
if (card==5 && suit=="Spades"){
	x.setAttribute("src", "5_of_spades.png");};
if (card==5 && suit=="Clubs"){
	x.setAttribute("src", "5_of_clubs.png");};
if (card==5 && suit=="Diamonds"){
	x.setAttribute("src", "5_of_diamonds.png");};
if (card==5 && suit=="Hearts"){
	x.setAttribute("src","5_of_hearts.png");};
if (card==6 && suit=="Spades"){
	x.setAttribute("src", "6_of_spades.png");}	;
if (card==6 && suit=="Clubs"){
	x.setAttribute("src", "6_of_clubs.png");}	;
if (card==6 && suit=="Diamonds"){
	x.setAttribute("src", "6_of_diamonds.png");}	;
if (card==6 && suit=="Hearts"){
	x.setAttribute("src", "6_of_hearts.png");}	;
if (card==7 && suit=="Spades"){
	x.setAttribute("src", "7_of_spades.png");}	;
if (card==8 && suit=="Spades"){
	x.setAttribute("src", "8_of_spades.png");}	;
if (card==9 && suit=="Spades"){
	x.setAttribute("src", "9_of_spades.png");}	;
if (card==10 && suit=="Spades"){
	x.setAttribute("src", "10_of_spades.png");}	;
if (card2=="Jack" && suit=="Spades"){
	x.setAttribute("src", "jack_of_spades2.png");}	;
if (card2=="Queen" && suit=="Spades"){
	x.setAttribute("src", "queen_of_spades2.png");}	;
if (card2=="King" && suit=="Spades"){
	x.setAttribute("src", "king_of_spades2.png");}	;
if (card==7 && suit=="Clubs"){
	x.setAttribute("src", "7_of_clubs.png");}	;
if (card==8 && suit=="Clubs"){
	x.setAttribute("src", "8_of_clubs.png");}	;
if (card==9 && suit=="Clubs"){
	x.setAttribute("src", "9_of_clubs.png");}	;
if (card==10 && suit=="Clubs"){
	x.setAttribute("src", "10_of_clubs.png");}	;
if (card2=="Jack" && suit=="Clubs"){
	x.setAttribute("src", "jack_of_clubs2.png");}	;
if (card2=="Queen" && suit=="Clubs"){
	x.setAttribute("src", "queen_of_clubs2.png");}	;
if (card2=="King" && suit=="Clubs"){
	x.setAttribute("src", "king_of_clubs2.png");}	;
if (card2==7 && suit=="Diamonds"){
	x.setAttribute("src", "7_of_diamonds.png");}	;
if (card==8 && suit=="Diamonds"){
	x.setAttribute("src", "8_of_diamonds.png");}	;
if (card==9 && suit=="Diamonds"){
	x.setAttribute("src", "9_of_diamonds.png");}	;
if (card==10 && suit=="Diamonds"){
	x.setAttribute("src", "10_of_diamonds.png");}	;
if (card2=="Jack" && suit=="Diamonds"){
	x.setAttribute("src", "jack_of_diamonds2.png");}	;
if (card2=="Queen" && suit=="Diamonds"){
	x.setAttribute("src", "queen_of_diamonds2.png");}	;
if (card2=="King" && suit=="Diamonds"){
	x.setAttribute("src", "king_of_diamonds2.png");}	;
if (card2==7 && suit=="Hearts"){
	x.setAttribute("src", "7_of_hearts.png");}	;
if (card==8 && suit=="Hearts"){
	x.setAttribute("src", "8_of_hearts.png");}	;
if (card==9 && suit=="Hearts"){
	x.setAttribute("src", "9_of_hearts.png");}	;
if (card2==10 && suit=="Hearts"){
	x.setAttribute("src", "10_of_hearts.png");}	;
if (card2=="Jack" && suit=="Hearts"){
	x.setAttribute("src", "jack_of_hearts2.png");}	;
if (card2=="Queen" && suit=="Hearts"){
	x.setAttribute("src", "queen_of_hearts2.png");}	;
if (card2=="King" && suit=="Hearts"){
	x.setAttribute("src", "king_of_hearts2.png");}	;
	
x.setAttribute("width", "120");
x.setAttribute("height", "170");
x.setAttribute("alt", "card");	
document.getElementById("dealerDIV").appendChild(x);} //say1 là bài của máy (dealer)
return cardValue(card,strWho);
}
	  
function NewHand(form){  //bắt đầu ván mới, called khi ấn DEAL
counte=0;
document.getElementById("pic").src="playing.jpg";
//**********************************************************************************************
var divUser = document.getElementById('userDIV');                          //thêm phần xóa các quân bài trước của Player để bắt đầu ván mới
while(divUser.firstChild){
    divUser.removeChild(divUser.firstChild);};
	
var divDealer = document.getElementById('dealerDIV');                     //thêm phần xóa các quân bài trước của Dealer để bắt đầu ván mới
while(divDealer.firstChild){
    divDealer.removeChild(divDealer.firstChild);};
//**********************************************************************************************
if(gameOver !=0) //gameOver là biến kiểu boolean, xem đã hết game chưa ??? bằng 0 là hết game rồi ???
{form.say1.value=("Hand in Play!"); form.say2.value=(""); return;} 
else
{form.dealer.value = 0; form.you.value = 0; cardCount=0;
form.dealer.value = eval(form.dealer.value) + PickACard("Dealer");
form.you.value = eval(form.you.value) + PickACard("You");
gameOver= -1; cardCount+=1;}
}
	  
function Dealer(form){  //function để máy bốc bài, called khi ấn 'STAND'
if (gameOver ==0)
{form.say1.value=("Deal the Cards!"); form.say2.value=(""); return;}
else
if(form.you.value<10)
{form.say1.value=("Not Below Ten!"); form.say2.value=("Take a Hit!"); return;}
else
if (cardCount <2)  //cardCount để đếm bài của người chơi, tối thiểu người chơi phải có 2 quân
{form.say1.value=("Minimum 2 Cards!"); form.say2.value=("Hit Again!"); return;}
else
while(form.dealer.value < 17){ //máy bốc liên tiếp cho đến khi có >17 điểm
form.dealer.value = eval(form.dealer.value) + PickACard("Dealer");}
}
function User(form){   //player bốc bài, called khi ấn 'HIT'
if (gameOver ==0)
{form.say1.value=("Deal the Cards!"); form.say2.value=(""); return;}
else
{cardCount+=1; form.say1.value=("You Get...");
form.you.value = eval(form.you.value) + PickACard("You");}
//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD	
if(form.you.value==21 && cardCount==2)						//thêm: có blackjack là thắng 
{form.say1.value=("Blackjack! You win!");					
gameOver=0; form.numgames.value=eval(form.numgames.value)+1;
document.getElementById("pic").src="Pwinner.jpg"}	
//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD
if(form.you.value > 21)
{form.say1.value=("You Busted!");
gameOver=0; form.numgames.value=eval(form.numgames.value)-1;
document.getElementById("pic").src="Plose.jpg"}
}
	  
function LookAtHands(form){
if (gameOver ==0 || form.you.value<10 || cardCount <2){return;}
else
if(form.dealer.value > 21) 
{form.say1.value=("House Busts!"); form.say2.value=("You Win! $$$$$$");
gameOver=0; form.numgames.value=eval(form.numgames.value)+1;
document.getElementById("pic").src="Pwinner.jpg";}
 else
if(form.you.value > form.dealer.value)
{form.say1.value=("You Win!"); form.say2.value=("$$$$$$$$$$$$$$$");
gameOver=0; form.numgames.value=eval(form.numgames.value)+1;
document.getElementById("pic").src="Pwinner.jpg";}
 else
 if(form.dealer.value == form.you.value)
{form.say1.value=("Game Tied!"); form.say2.value=("Try Again!");
gameOver=0; form.numgames.value=eval(form.numgames.value)-1;
document.getElementById("pic").src="Plose.jpg";}
 else {
form.say1.value=("House Wins!"); form.say2.value=("Tough Luck!");
gameOver=0; form.numgames.value=eval(form.numgames.value)-1;
document.getElementById("pic").src="Plose.jpg";}
}
	  
function setBj(){
gameOver=0; cardCount=0; 
document.display.dealer.value=""; 
document.display.you.value="";
document.display.numgames.value="0";
document.display.say1.value="    Hit 'Deal'";
document.display.say2.value="    To Start!";
}
window.onload = setBj;
// End -->
</script>
	
</head>

<body>
<a href="https://www.javascriptbank.com/blackjack.html">Original version</a>
<form name="display">
<table bgcolor="#c0c0c0" border="1" cellspacing="0" cellpadding="3" align="center" <!--style="width:600px;height:115px"-->> <!--thêm align="center-->
<tbody><tr>
<td><center>Score:</center></td>
<td><center>Dealer</center></td>
<td><center><input type="text" name="dealer" size="2"></center></td>
<td><center>Card(s):  <input type="text" name="say1" size="18" value=""></center></td>
</tr>
<tr>
<td><center><input type="text" name="numgames" size="3" value="0"></center></td>
<td><center>Player</center></td>
<td><center><input type="text" name="you" size="2"></center></td>
<td><center>Card(s):  <input type="text" name="say2" size="18" value=""></center></td>
</tr>
<tr>
<td><center><input type="button" value="Deal" onclick="NewHand(this.form)"></center></td> 
<td colspan="3"><center>
<input type="button" value="Stand" onclick="Dealer(this.form);LookAtHands(this.form);">  
<input type="button" value=" Hit " onclick="User(this.form)"></center></td></tr>         
</tbody>
</table>
</form>	
<!--$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$-->
<div id="dealerDIV" align= "center">
	 <p style="font-size:250%;font-family:Monotype Corsiva;color:BlanchedAlmond;">Dealer's cards</p>
</div>
<div id="userDIV" align= "center">
	<p style="font-size:250%;font-family:Monotype Corsiva;color:BlanchedAlmond;">Your cards</p>
</div>	
<div id="resultDIV" align="center">
	<p id="result" style="font-size:250%;font-family:Monotype Corsiva;color:BlanchedAlmond;"></p>
	<img id="pic" src="playing.jpg" style="width:150px;height:150px;">
</div>
<!--$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$-->
</body>
</html>
